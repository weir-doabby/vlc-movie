<!doctype html>
</header>


<div style="height:18px"></div>


<div class="card">
<div class="left">
<label>ุขุฏุฑุณ ูุงู ุง ูพุฎุดโุฌุฑุงู (http/https)</label>
<input id="url" type="text" placeholder="ูุซุงู: http://example.com/movie.mkv" />
<div class="actions">
<button id="gen" class="btn primary micro">๐ฏ ุชููุฏ ููฺฉ ฺฉูุชุงู</button>
<button id="previewBtn" class="btn ghost micro">๐ ูพุดโููุงุด</button>
</div>


<div id="result" style="margin-top:12px;display:none;">
<div class="shareRow">
<div class="shareField">
<input id="shareUrl" readonly />
<button id="copyBtn" class="btn micro">ฺฉูพ</button>
</div>
<button id="shareBtn" class="btn micro">ุงุดุชุฑุงฺฉ</button>
</div>


<div style="margin-top:12px;display:flex;gap:8px;align-items:center">
<a id="openVlc" class="vbtn" href="#">โถ๏ธ ุจุงุฒ ุฏุฑ VLC</a>
<a id="direct" href="#" class="btn micro">โฌ ุฏุงูููุฏ ูุณุชูู</a>
</div>
</div>
</div>


<div class="preview">
<div class="media shimmer" id="metaBox">ูพุดโููุงุด ูุงู ู ูุชุงุฏุชุง</div>
</div>
</div>


<footer>ุณุงุฎุชู ุดุฏู ุจุง โค๏ธ โ ูโุชูุงูุฏ ุขู ุฑุง ุจู ุฏูุฎูุงู ุฎูุฏ ุณูุงุฑุด ฺฉูุฏ.</footer>
</div>


<script>
const gen = document.getElementById('gen');
const urlInput = document.getElementById('url');
const result = document.getElementById('result');
const shareUrl = document.getElementById('shareUrl');
const copyBtn = document.getElementById('copyBtn');
const shareBtn = document.getElementById('shareBtn');
const openVlc = document.getElementById('openVlc');
const direct = document.getElementById('direct');
const metaBox = document.getElementById('metaBox');


function isValidUrl(s){ try { new URL(s); return true } catch(e){return false} }


gen.addEventListener('click', async ()=>{
const url = urlInput.value.trim();
if(!isValidUrl(url)){ alert('ูุทูุง ฺฉ ุขุฏุฑุณ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ'); return }


gen.disabled = true; gen.textContent = 'ุฏุฑุญุงู ุณุงุฎุช...';
try{
const resp = await fetch('/api/links', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url})});
const data = await resp.json();
if(data.shareUrl){
result.style.display='block';
shareUrl.value = data.shareUrl;
openVlc.href = `vlc://${url}`; // ููฺฉ ุจุฑุง ุจุงุฒ ฺฉุฑุฏู ุฏุฑ VLC
direct.href = url;
metaBox.textContent = 'ุขุฏ: ' + data.id + ' โ ุขูุงุฏูู ุงุดุชุฑุงฺฉ';
} else {
alert('ุฎุทุง ุฏุฑ ุณุฑูุฑ');
}
}catch(e){ alert('ุฎุทุง: '+e.message) }
gen.disabled=false; gen.textContent='๐ฏ ุชููุฏ ููฺฉ ฺฉูุชุงู';
});


copyBtn.addEventListener('click', ()=>{ navigator.clipboard.writeText(shareUrl.value).then(()=>{copyBtn.textContent='ฺฉูพ ุดุฏ'; setTimeout(()=>copyBtn.textContent='ฺฉูพ',1500)}) });


shareBtn.addEventListener('click', ()=>{
if(navigator.share){ navigator.share({title:'ููฺฉ ูุฏู',text:'ููฺฉ ูุฏู',url:shareUrl.value}) }
else {
